(function(e){var s,t,u,v,w,x,g={},y={},l={},B=0,z={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0},data:{key:{children:"children",name:"name",title:""},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null}},m=[function(e){var a=e.treeObj,c=b.event;a.unbind(c.NODECREATED);a.bind(c.NODECREATED,function(a,b,c){d.apply(e.callback.onNodeCreated,[a,b,c])});a.unbind(c.CLICK);a.bind(c.CLICK,function(a,b,c,f){d.apply(e.callback.onClick,[a,b,c,f])});a.unbind(c.EXPAND);a.bind(c.EXPAND,function(a,b,c){d.apply(e.callback.onExpand,[a,b,c])});a.unbind(c.COLLAPSE);a.bind(c.COLLAPSE,function(a,b,c){d.apply(e.callback.onCollapse,[a,b,c])});a.unbind(c.ASYNC_SUCCESS);a.bind(c.ASYNC_SUCCESS,function(a,b,c,f){d.apply(e.callback.onAsyncSuccess,[a,b,c,f])});a.unbind(c.ASYNC_ERROR);a.bind(c.ASYNC_ERROR,function(a,b,g,h,f,c){d.apply(e.callback.onAsyncError,[a,b,g,h,f,c])})}],k=[function(c){var b=a.getCache(c);b||(b={},a.setCache(c,b));b.nodes=[];b.doms=[]}],n=[function(c,g,b,e,h,i){if(b){var f=c.data.key.children;b.level=g;b.tId=c.treeId+"_"+ ++B;b.parentTId=e?e.tId:null;if(b[f]&&b[f].length>0){if(typeof b.open=="string")b.open=d.eqs(b.open,"true");b.open=!!b.open;b.isParent=!0;b.zAsync=!0}else{b.open=!1;if(typeof b.isParent=="string")b.isParent=d.eqs(b.isParent,"true");b.isParent=!!b.isParent;b.zAsync=!b.isParent}b.isFirstNode=h;b.isLastNode=i;b.getParentNode=function(){return a.getNodeCache(c,b.parentTId)};b.getPreNode=function(){return a.getPreNode(c,b)};b.getNextNode=function(){return a.getNextNode(c,b)};b.isAjaxing=!1;a.fixPIdKeyValue(c,b)}}],o=[function(c){var e=c.target,f=g[c.data.treeId],h="",m=null,i="",j="",n=null,l=null,k=null;if(d.eqs(c.type,"mousedown"))j="mousedown";else if(d.eqs(c.type,"mouseup"))j="mouseup";else if(d.eqs(c.type,"contextmenu"))j="contextmenu";else if(d.eqs(c.type,"click")){if(d.eqs(e.tagName,"button")&&e.blur(),d.eqs(e.tagName,"button")&&e.getAttribute("treeNode"+b.id.SWITCH)!==null)h=e.parentNode.id,i="switchNode";else if(k=d.getMDom(f,e,[{tagName:"a",attrName:"treeNode"+b.id.A}]))h=k.parentNode.id,i="clickNode"}else if(d.eqs(c.type,"dblclick")&&(j="dblclick",k=d.getMDom(f,e,[{tagName:"a",attrName:"treeNode"+b.id.A}])))h=k.parentNode.id,i="switchNode";if(j.length>0&&h.length==0&&(k=d.getMDom(f,e,[{tagName:"a",attrName:"treeNode"+b.id.A}])))h=k.parentNode.id;if(h.length>0)switch(m=a.getNodeCache(f,h),i){case"switchNode":m.isParent?d.eqs(c.type,"click")||d.eqs(c.type,"dblclick")&&d.apply(f.view.dblClickExpand,[f.treeId,m],f.view.dblClickExpand)?(n=s):(i=""):(i="");break;case"clickNode":n=t}switch(j){case"mousedown":l=u;break;case"mouseup":l=v;break;case"dblclick":l=w;break;case"contextmenu":l=x}return{stop:!1,node:m,nodeEventType:i,nodeEventCallback:n,treeEventType:j,treeEventCallback:l}}],p=[function(c){var b=a.getRoot(c);b||(b={},a.setRoot(c,b));b.children=[];b.expandTriggerFlag=!1;b.curSelectedList=[];b.noSelection=!0;b.createdNodes=[]}],q=[],r=[],h=[],i=[],j=[],a={addNodeCache:function(c,b){a.getCache(c).nodes[b.tId]=b},addAfterA:function(a){r.push(a)},addBeforeA:function(a){q.push(a)},addInnerAfterA:function(a){i.push(a)},addInnerBeforeA:function(a){h.push(a)},addInitBind:function(a){m.push(a)},addInitCache:function(a){k.push(a)},addInitNode:function(a){n.push(a)},addInitProxy:function(a){o.push(a)},addInitRoot:function(a){p.push(a)},addNodesData:function(d,a,e){var b=d.data.key.children;a[b]||(a[b]=[]);if(a[b].length>0)a[b][a[b].length-1].isLastNode=!1,c.setNodeLineIcos(d,a[b][a[b].length-1]);a.isParent=!0;a[b]=a[b].concat(e)},addSelectedNode:function(c,b){var d=a.getRoot(c);a.isSelectedNode(c,b)||d.curSelectedList.push(b)},addCreatedNode:function(b,c){(b.callback.onNodeCreated||b.view.addDiyDom)&&a.getRoot(b).createdNodes.push(c)},addZTreeTools:function(a){j.push(a)},exSetting:function(a){e.extend(!0,z,a)},fixPIdKeyValue:function(a,b){a.data.simpleData.enable&&(b[a.data.simpleData.pIdKey]=b.parentTId?b.getParentNode()[a.data.simpleData.idKey]:a.data.simpleData.rootPId)},getAfterA:function(){for(var a=0,b=r.length;a<b;a++)r[a].apply(this,arguments)},getBeforeA:function(){for(var a=0,b=q.length;a<b;a++)q[a].apply(this,arguments)},getInnerAfterA:function(){for(var a=0,b=i.length;a<b;a++)i[a].apply(this,arguments)},getInnerBeforeA:function(){for(var a=0,b=h.length;a<b;a++)h[a].apply(this,arguments)},getCache:function(a){return l[a.treeId]},getNextNode:function(f,b){if(!b)return null;var c=f.data.key.children,d=b.parentTId?b.getParentNode():a.getRoot(f);if(!b.isLastNode)if(b.isFirstNode)return d[c][1];else for(var e=1,g=d[c].length-1;e<g;e++)if(d[c][e]===b)return d[c][e+1];return null},getNodeByParam:function(e,b,d,f){if(!b||!d)return null;for(var h=e.data.key.children,c=0,i=b.length;c<i;c++){if(b[c][d]==f)return b[c];var g=a.getNodeByParam(e,b[c][h],d,f);if(g)return g}return null},getNodeCache:function(c,a){if(!a)return null;var b=l[c.treeId].nodes[a];return b?b:null},getNodes:function(b){return a.getRoot(b)[b.data.key.children]},getNodesByParam:function(f,b,e,g){if(!b||!e)return[];for(var h=f.data.key.children,d=[],c=0,i=b.length;c<i;c++)b[c][e]==g&&d.push(b[c]),d=d.concat(a.getNodesByParam(f,b[c][h],e,g));return d},getNodesByParamFuzzy:function(f,b,d,g){if(!b||!d)return[];for(var h=f.data.key.children,e=[],c=0,i=b.length;c<i;c++)typeof b[c][d]=="string"&&b[c][d].indexOf(g)>-1&&e.push(b[c]),e=e.concat(a.getNodesByParamFuzzy(f,b[c][h],d,g));return e},getPreNode:function(f,b){if(!b)return null;var c=f.data.key.children,d=b.parentTId?b.getParentNode():a.getRoot(f);if(!b.isFirstNode)if(b.isLastNode)return d[c][d[c].length-2];else for(var e=1,g=d[c].length-1;e<g;e++)if(d[c][e]===b)return d[c][e-1];return null},getRoot:function(a){return a?y[a.treeId]:null},getSetting:function(a){return g[a]},getSettings:function(){return g},getTitleKey:function(a){return a.data.key.title===""?a.data.key.name:a.data.key.title},getZTreeTools:function(a){return(a=this.getRoot(this.getSetting(a)))?a.treeTools:null},initCache:function(){for(var a=0,b=k.length;a<b;a++)k[a].apply(this,arguments)},initNode:function(){for(var a=0,b=n.length;a<b;a++)n[a].apply(this,arguments)},initRoot:function(){for(var a=0,b=p.length;a<b;a++)p[a].apply(this,arguments)},isSelectedNode:function(e,d){for(var c=a.getRoot(e),b=0,f=c.curSelectedList.length;b<f;b++)if(d===c.curSelectedList[b])return!0;return!1},removeNodeCache:function(c,b){var d=c.data.key.children;if(b[d])for(var e=0,f=b[d].length;e<f;e++)arguments.callee(c,b[d][e]);delete a.getCache(c).nodes[b.tId]},removeSelectedNode:function(d,f){for(var c=a.getRoot(d),b=0,e=c.curSelectedList.length;b<e;b++)if(f===c.curSelectedList[b]||!a.getNodeCache(d,c.curSelectedList[b].tId))c.curSelectedList.splice(b,1),b--,e--},setCache:function(b,a){l[b.treeId]=a},setRoot:function(b,a){y[b.treeId]=a},setZTreeTools:function(){for(var a=0,b=j.length;a<b;a++)j[a].apply(this,arguments)},transformToArrayFormat:function(g,b){if(!b)return[];var f=g.data.key.children,c=[];if(d.isArray(b))for(var e=0,h=b.length;e<h;e++)c.push(b[e]),b[e][f]&&(c=c.concat(a.transformToArrayFormat(g,b[e][f])));else c.push(b),b[f]&&(c=c.concat(a.transformToArrayFormat(g,b[f])));return c},transformTozTreeFormat:function(h,b){var a,f,g=h.data.simpleData.idKey,e=h.data.simpleData.pIdKey,i=h.data.key.children;if(!g||g==""||!b)return[];if(d.isArray(b)){var j=[],c=[];for(a=0,f=b.length;a<f;a++)c[b[a][g]]=b[a];for(a=0,f=b.length;a<f;a++)c[b[a][e]]&&b[a][g]!=b[a][e]?(c[b[a][e]][i]||(c[b[a][e]][i]=[]),c[b[a][e]][i].push(b[a])):j.push(b[a]);return j}else return[b]}},f={bindEvent:function(){for(var a=0,b=m.length;a<b;a++)m[a].apply(this,arguments)},bindTree:function(a){var b={treeId:a.treeId},a=a.treeObj;a.unbind("click",f.proxy);a.bind("click",b,f.proxy);a.unbind("dblclick",f.proxy);a.bind("dblclick",b,f.proxy);a.unbind("mouseover",f.proxy);a.bind("mouseover",b,f.proxy);a.unbind("mouseout",f.proxy);a.bind("mouseout",b,f.proxy);a.unbind("mousedown",f.proxy);a.bind("mousedown",b,f.proxy);a.unbind("mouseup",f.proxy);a.bind("mouseup",b,f.proxy);a.unbind("contextmenu",f.proxy);a.bind("contextmenu",b,f.proxy)},doProxy:function(){for(var b=[],a=0,d=o.length;a<d;a++){var c=o[a].apply(this,arguments);b.push(c);if(c.stop)break}return b},proxy:function(c){var j=a.getSetting(c.data.treeId);if(!d.uCanDo(j,c))return!0;for(var k=f.doProxy(c),g=!0,h=!1,i=0,l=k.length;i<l;i++){var b=k[i];b.nodeEventCallback&&(h=!0,g=b.nodeEventCallback.apply(b,[c,b.node])&&g);b.treeEventCallback&&(h=!0,g=b.treeEventCallback.apply(b,[c,b.node])&&g)}try{h&&e("input:focus").length==0&&d.noSel(j)}catch(m){}return g}};s=function(f,e){var b=g[f.data.treeId];if(e.open){if(d.apply(b.callback.beforeCollapse,[b.treeId,e],!0)==!1)return!0}else if(d.apply(b.callback.beforeExpand,[b.treeId,e],!0)==!1)return!0;a.getRoot(b).expandTriggerFlag=!0;c.switchNode(b,e);return!0};t=function(i,f){var e=g[i.data.treeId],h=e.view.autoCancelSelected&&i.ctrlKey&&a.isSelectedNode(e,f)?0:e.view.autoCancelSelected&&i.ctrlKey&&e.view.selectedMulti?2:1;if(d.apply(e.callback.beforeClick,[e.treeId,f,h],!0)==!1)return!0;h===0?c.cancelPreSelectedNode(e,f):c.selectNode(e,f,h===2);e.treeObj.trigger(b.event.CLICK,[e.treeId,f,h]);return!0};u=function(c,b){var a=g[c.data.treeId];d.apply(a.callback.beforeMouseDown,[a.treeId,b],!0)&&d.apply(a.callback.onMouseDown,[c,a.treeId,b]);return!0};v=function(c,b){var a=g[c.data.treeId];d.apply(a.callback.beforeMouseUp,[a.treeId,b],!0)&&d.apply(a.callback.onMouseUp,[c,a.treeId,b]);return!0};w=function(c,b){var a=g[c.data.treeId];d.apply(a.callback.beforeDblClick,[a.treeId,b],!0)&&d.apply(a.callback.onDblClick,[c,a.treeId,b]);return!0};x=function(c,b){var a=g[c.data.treeId];d.apply(a.callback.beforeRightClick,[a.treeId,b],!0)&&d.apply(a.callback.onRightClick,[c,a.treeId,b]);return typeof a.callback.onRightClick!="function"};var d={apply:function(b,a,c){return typeof b=="function"?b.apply(A,a?a:[]):c},canAsync:function(c,a){var b=c.data.key.children;return a&&a.isParent&&!(a.zAsync||a[b]&&a[b].length>0)},clone:function(a){var b;if(a instanceof Array){b=[];for(var c=a.length;c--;)b[c]=arguments.callee(a[c]);return b}else if(typeof a=="function")return a;else if(a instanceof Object){b={};for(c in a)b[c]=arguments.callee(a[c]);return b}else return a},eqs:function(b,a){return b.toLowerCase()===a.toLowerCase()},isArray:function(a){return Object.prototype.toString.apply(a)==="[object Array]"},getMDom:function(e,a,c){if(!a)return null;for(;a&&a.id!==e.treeId;){for(var b=0,f=c.length;a.tagName&&b<f;b++)if(d.eqs(a.tagName,c[b].tagName)&&a.getAttribute(c[b].attrName)!==null)return a;a=a.parentNode}return null},noSel:function(b){if(a.getRoot(b).noSelection)try{window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()}catch(c){}},uCanDo:function(){return!0}},c={addNodes:function(g,f,h,i){if(!g.data.keep.leaf||!f||f.isParent)if(d.isArray(h)||(h=[h]),g.data.simpleData.enable&&(h=a.transformTozTreeFormat(g,h)),f){var j=e("#"+f.tId+b.id.SWITCH),k=e("#"+f.tId+b.id.ICON),l=e("#"+f.tId+b.id.UL);if(!f.open)c.replaceSwitchClass(f,j,b.folder.CLOSE),c.replaceIcoClass(f,k,b.folder.CLOSE),f.open=!1,l.css({display:"none"});a.addNodesData(g,f,h);c.createNodes(g,f.level+1,h,f);i||c.expandCollapseParentNode(g,f,!0)}else a.addNodesData(g,a.getRoot(g),h),c.createNodes(g,0,h,null)},appendNodes:function(f,p,i,m,q,n){if(!i)return[];for(var g=[],k=f.data.key.children,s=f.data.key.name,r=a.getTitleKey(f),j=0,v=i.length;j<v;j++){var e=i[j],l=(m?m:a.getRoot(f))[k].length==i.length&&j==0,h=j==i.length-1;q&&(a.initNode(f,p,e,m,l,h,n),a.addNodeCache(f,e));l=[];e[k]&&e[k].length>0&&(l=c.appendNodes(f,p+1,e[k],e,q,n&&e.open));if(n){var h=c.makeNodeUrl(f,e),t=c.makeNodeFontCss(f,e),u=[],o;for(o in t)u.push(o,":",t[o],";");g.push("<li id='",e.tId,"' class='level",e.level,"' treenode>","<button type='button' hidefocus='true'",e.isParent?"":"disabled"," id='",e.tId,b.id.SWITCH,"' title='' class='",c.makeNodeLineClass(f,e),"' treeNode",b.id.SWITCH,"></button>");a.getBeforeA(f,e,g);g.push("<a id='",e.tId,b.id.A,"' class='level",e.level,"' treeNode",b.id.A,' onclick="',e.click||"",'" ',h!=null&&h.length>0?"href='"+h+"'":""," target='",c.makeNodeTarget(e),"' style='",u.join(""),"'");d.apply(f.view.showTitle,[f.treeId,e],f.view.showTitle)&&e[r]&&g.push("title='",e[r].replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'");g.push(">");a.getInnerBeforeA(f,e,g);h=f.view.nameIsHTML?e[s]:e[s].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");g.push("<button type='button' hidefocus='true' id='",e.tId,b.id.ICON,"' title='' treeNode",b.id.ICON," class='",c.makeNodeIcoClass(f,e),"' style='",c.makeNodeIcoStyle(f,e),"'></button><span id='",e.tId,b.id.SPAN,"'>",h,"</span>");a.getInnerAfterA(f,e,g);g.push("</a>");a.getAfterA(f,e,g);e.isParent&&e.open&&c.makeUlHtml(f,e,g,l.join(""));g.push("</li>");a.addCreatedNode(f,e)}}return g},appendParentULDom:function(d,a){var g=[],f=e("#"+a.tId),h=e("#"+a.tId+b.id.UL),i=c.appendNodes(d,a.level+1,a[d.data.key.children],a,!1,!0);c.makeUlHtml(d,a,g,i.join(""));!f.get(0)&&a.parentTId&&(c.appendParentULDom(d,a.getParentNode()),f=e("#"+a.tId));h.get(0)&&h.remove();f.append(g.join(""));c.createNodeCallback(d)},asyncNode:function(a,f,p,n){var g,m;if(f&&!f.isParent)return d.apply(n),!1;else if(f&&f.isAjaxing)return!1;else if(d.apply(a.callback.beforeAsync,[a.treeId,f],!0)==!1)return d.apply(n),!1;if(f)f.isAjaxing=!0,e("#"+f.tId+b.id.ICON).attr({style:"","class":"ico_loading"});var k=a.async.contentType=="application/json",h=k?"{":"",i="";for(g=0,m=a.async.autoParam.length;f&&g<m;g++){var j=a.async.autoParam[g].split("="),o=j;j.length>1&&(o=j[1],j=j[0]);k?(i=typeof f[j]=="string"?'"':"",h+='"'+o+('":'+i+f[j]).replace(/'/g,"\\'")+i+","):(h+=o+("="+f[j]).replace(/&/g,"%26")+"&")}if(d.isArray(a.async.otherParam))for(g=0,m=a.async.otherParam.length;g<m;g+=2)k?(i=typeof a.async.otherParam[g+1]=="string"?'"':"",h+='"'+a.async.otherParam[g]+('":'+i+a.async.otherParam[g+1]).replace(/'/g,"\\'")+i+","):(h+=a.async.otherParam[g]+("="+a.async.otherParam[g+1]).replace(/&/g,"%26")+"&");else for(var l in a.async.otherParam)k?(i=typeof a.async.otherParam[l]=="string"?'"':"",h+='"'+l+('":'+i+a.async.otherParam[l]).replace(/'/g,"\\'")+i+","):(h+=l+("="+a.async.otherParam[l]).replace(/&/g,"%26")+"&");h.length>1&&(h=h.substring(0,h.length-1));k&&(h+="}");e.ajax({contentType:a.async.contentType,type:a.async.type,url:d.apply(a.async.url,[a.treeId,f],a.async.url),data:h,dataType:a.async.dataType,success:function(g){var e=[];try{e=!g||g.length==0?[]:typeof g=="string"?eval("("+g+")"):g}catch(h){}if(f)f.isAjaxing=null,f.zAsync=!0;c.setNodeLineIcos(a,f);e&&e!=""?(e=d.apply(a.async.dataFilter,[a.treeId,f,e],e),c.addNodes(a,f,d.clone(e),!!p)):c.addNodes(a,f,[],!!p);a.treeObj.trigger(b.event.ASYNC_SUCCESS,[a.treeId,f,g]);d.apply(n)},error:function(d,e,g){c.setNodeLineIcos(a,f);if(f)f.isAjaxing=null;a.treeObj.trigger(b.event.ASYNC_ERROR,[a.treeId,f,d,e,g])}});return!0},cancelPreSelectedNode:function(g,d){for(var h=a.getRoot(g).curSelectedList,f=h.length-1;f>=0;f--)if(!d||d===h[f])if(e("#"+h[f].tId+b.id.A).removeClass(b.node.CURSELECTED),c.setNodeName(g,h[f]),d){a.removeSelectedNode(g,d);break}if(!d)a.getRoot(g).curSelectedList=[]},createNodeCallback:function(c){if(c.callback.onNodeCreated||c.view.addDiyDom)for(var e=a.getRoot(c);e.createdNodes.length>0;){var f=e.createdNodes.shift();d.apply(c.view.addDiyDom,[c.treeId,f]);c.callback.onNodeCreated&&c.treeObj.trigger(b.event.NODECREATED,[c.treeId,f])}},createNodes:function(f,g,h,d){if(h&&h.length!=0){var j=a.getRoot(f),i=f.data.key.children,i=!d||d.open||!!e("#"+d[i][0].tId).get(0);j.createdNodes=[];g=c.appendNodes(f,g,h,d,!0,i);d?(d=e("#"+d.tId+b.id.UL),d.get(0)&&d.append(g.join(""))):f.treeObj.append(g.join(""));c.createNodeCallback(f)}},expandCollapseNode:function(g,f,i,m,h){var k=a.getRoot(g),j=g.data.key.children;if(f){if(k.expandTriggerFlag){var n=h,h=function(){n&&n();f.open?g.treeObj.trigger(b.event.EXPAND,[g.treeId,f]):g.treeObj.trigger(b.event.COLLAPSE,[g.treeId,f])};k.expandTriggerFlag=!1}if(f.open==i)d.apply(h,[]);else{!f.open&&f.isParent&&(!e("#"+f.tId+b.id.UL).get(0)||f[j]&&f[j].length>0&&!e("#"+f[j][0].tId).get(0))&&c.appendParentULDom(g,f);var i=e("#"+f.tId+b.id.UL),k=e("#"+f.tId+b.id.SWITCH),l=e("#"+f.tId+b.id.ICON);f.isParent?(f.open=!f.open,f.iconOpen&&f.iconClose&&l.attr("style",c.makeNodeIcoStyle(g,f)),f.open?(c.replaceSwitchClass(f,k,b.folder.OPEN),c.replaceIcoClass(f,l,b.folder.OPEN),m==!1||g.view.expandSpeed==""?(i.show(),d.apply(h,[])):f[j]&&f[j].length>0?i.slideDown(g.view.expandSpeed,h):(i.show(),d.apply(h,[]))):(c.replaceSwitchClass(f,k,b.folder.CLOSE),c.replaceIcoClass(f,l,b.folder.CLOSE),m==!1||g.view.expandSpeed==""?(i.hide(),d.apply(h,[])):i.slideUp(g.view.expandSpeed,h))):d.apply(h,[])}}else d.apply(h,[])},expandCollapseParentNode:function(b,a,d,e,f){a&&(a.parentTId?(c.expandCollapseNode(b,a,d,e),a.parentTId&&c.expandCollapseParentNode(b,a.getParentNode(),d,e,f)):c.expandCollapseNode(b,a,d,e,f))},expandCollapseSonNode:function(b,e,h,i,j){var d=a.getRoot(b),g=b.data.key.children,d=e?e[g]:d[g],g=e?!1:i,k=a.getRoot(b).expandTriggerFlag;a.getRoot(b).expandTriggerFlag=!1;if(d)for(var f=0,l=d.length;f<l;f++)d[f]&&c.expandCollapseSonNode(b,d[f],h,g);a.getRoot(b).expandTriggerFlag=k;c.expandCollapseNode(b,e,h,i,j)},makeNodeFontCss:function(a,c){var b=d.apply(a.view.fontCss,[a.treeId,c],a.view.fontCss);return b&&typeof b!="function"?b:{}},makeNodeIcoClass:function(d,a){var c=["ico"];a.isAjaxing||(c[0]=(a.iconSkin?a.iconSkin+"_":"")+c[0],a.isParent?c.push(a.open?b.folder.OPEN:b.folder.CLOSE):c.push(b.folder.DOCU));return c.join("_")},makeNodeIcoStyle:function(b,a){var c=[];if(!a.isAjaxing){var e=a.isParent&&a.iconOpen&&a.iconClose?a.open?a.iconOpen:a.iconClose:a.icon;e&&c.push("background:url(",e,") 0 0 no-repeat;");(b.view.showIcon==!1||!d.apply(b.view.showIcon,[b.treeId,a],!0))&&c.push("width:0px;height:0px;")}return c.join("")},makeNodeLineClass:function(e,a){var d=[];e.view.showLine?a.level==0&&a.isFirstNode&&a.isLastNode?d.push(b.line.ROOT):a.level==0&&a.isFirstNode?d.push(b.line.ROOTS):a.isLastNode?d.push(b.line.BOTTOM):d.push(b.line.CENTER):d.push(b.line.NOLINE);a.isParent?d.push(a.open?b.folder.OPEN:b.folder.CLOSE):d.push(b.folder.DOCU);return c.makeNodeLineClassEx(a)+d.join("_")},makeNodeLineClassEx:function(a){return"level"+a.level+" switch "},makeNodeTarget:function(a){return a.target||"_blank"},makeNodeUrl:function(b,a){return a.url?a.url:null},makeUlHtml:function(e,a,d,f){d.push("<ul id='",a.tId,b.id.UL,"' class='level",a.level," ",c.makeUlLineClass(e,a),"' style='display:",a.open?"block":"none","'>");d.push(f);d.push("</ul>")},makeUlLineClass:function(c,a){return c.view.showLine&&!a.isLastNode?b.line.LINE:""},replaceIcoClass:function(a,c,d){if(c&&!a.isAjaxing&&(a=c.attr("class"),a!=void 0)){a=a.split("_");switch(d){case b.folder.OPEN:case b.folder.CLOSE:case b.folder.DOCU:a[a.length-1]=d}c.attr("class",a.join("_"))}},replaceSwitchClass:function(f,d,e){if(d){var a=d.attr("class");if(a!=void 0){a=a.split("_");switch(e){case b.line.ROOT:case b.line.ROOTS:case b.line.CENTER:case b.line.BOTTOM:case b.line.NOLINE:a[0]=c.makeNodeLineClassEx(f)+e;break;case b.folder.OPEN:case b.folder.CLOSE:case b.folder.DOCU:a[1]=e}d.attr("class",a.join("_"));e!==b.folder.DOCU?d.removeAttr("disabled"):d.attr("disabled","disabled")}}},selectNode:function(f,d,g){g||c.cancelPreSelectedNode(f);e("#"+d.tId+b.id.A).addClass(b.node.CURSELECTED);a.addSelectedNode(f,d)},setNodeFontCss:function(f,a){var g=e("#"+a.tId+b.id.A),d=c.makeNodeFontCss(f,a);d&&g.css(d)},setNodeLineIcos:function(d,a){if(a){var f=e("#"+a.tId+b.id.SWITCH),h=e("#"+a.tId+b.id.UL),g=e("#"+a.tId+b.id.ICON),i=c.makeUlLineClass(d,a);i.length==0?h.removeClass(b.line.LINE):h.addClass(i);f.attr("class",c.makeNodeLineClass(d,a));a.isParent?f.removeAttr("disabled"):f.attr("disabled","disabled");g.removeAttr("style");g.attr("style",c.makeNodeIcoStyle(d,a));g.attr("class",c.makeNodeIcoClass(d,a))}},setNodeName:function(f,c){var h=f.data.key.name,i=a.getTitleKey(f),g=e("#"+c.tId+b.id.SPAN);g.empty();f.view.nameIsHTML?g.html(c[h]):g.text(c[h]);d.apply(f.view.showTitle,[f.treeId,c],f.view.showTitle)&&c[i]&&e("#"+c.tId+b.id.A).attr("title",c[i])},setNodeTarget:function(a){e("#"+a.tId+b.id.A).attr("target",c.makeNodeTarget(a))},setNodeUrl:function(g,d){var f=e("#"+d.tId+b.id.A),a=c.makeNodeUrl(g,d);a==null||a.length==0?f.removeAttr("href"):f.attr("href",a)},switchNode:function(b,a){a.open||!d.canAsync(b,a)?c.expandCollapseNode(b,a,!a.open):b.async.enable?c.asyncNode(b,a)||c.expandCollapseNode(b,a,!a.open):a&&c.expandCollapseNode(b,a,!a.open)}};e.fn.zTree={consts:{event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:d,view:c,event:f,data:a},getZTreeObj:function(b){return(b=a.getZTreeTools(b))?b:null},init:function(j,k,i){var h=d.clone(z);e.extend(!0,h,k);h.treeId=j.attr("id");h.treeObj=j;h.treeObj.empty();g[h.treeId]=h;if(e.browser.msie&&parseInt(e.browser.version)<7)h.view.expandSpeed="";a.initRoot(h);j=a.getRoot(h);k=h.data.key.children;i=i?d.clone(d.isArray(i)?i:[i]):[];j[k]=h.data.simpleData.enable?a.transformTozTreeFormat(h,i):i;a.initCache(h);f.bindTree(h);f.bindEvent(h);i={setting:h,cancelSelectedNode:function(a){c.cancelPreSelectedNode(this.setting,a)},expandAll:function(a){a=!!a;c.expandCollapseSonNode(this.setting,null,a,!0);return a},expandNode:function(f,g,j,k,i){if(!f||!f.isParent)return null;g!==!0&&g!==!1&&(g=!f.open);if((i=!!i)&&g&&d.apply(h.callback.beforeExpand,[h.treeId,f],!0)==!1)return null;else if(i&&!g&&d.apply(h.callback.beforeCollapse,[h.treeId,f],!0)==!1)return null;g&&f.parentTId&&c.expandCollapseParentNode(this.setting,f.getParentNode(),g,!1);if(g===f.open&&!j)return null;a.getRoot(h).expandTriggerFlag=i;j?c.expandCollapseSonNode(this.setting,f,g,!0,function(){k!==!1&&e("#"+f.tId+b.id.ICON).focus().blur()}):(f.open=!g,c.switchNode(this.setting,f),k!==!1&&e("#"+f.tId+b.id.ICON).focus().blur());return g},getNodes:function(){return a.getNodes(this.setting)},getNodeByParam:function(b,d,c){return!b?null:a.getNodeByParam(this.setting,c?c[this.setting.data.key.children]:a.getNodes(this.setting),b,d)},getNodeByTId:function(b){return a.getNodeCache(this.setting,b)},getNodesByParam:function(b,d,c){return!b?null:a.getNodesByParam(this.setting,c?c[this.setting.data.key.children]:a.getNodes(this.setting),b,d)},getNodesByParamFuzzy:function(b,d,c){return!b?null:a.getNodesByParamFuzzy(this.setting,c?c[this.setting.data.key.children]:a.getNodes(this.setting),b,d)},getNodeIndex:function(b){if(!b)return null;for(var d=h.data.key.children,e=b.parentTId?b.getParentNode():a.getRoot(this.setting),c=0,f=e[d].length;c<f;c++)if(e[d][c]==b)return c;return-1},getSelectedNodes:function(){for(var c=[],d=a.getRoot(this.setting).curSelectedList,b=0,e=d.length;b<e;b++)c.push(d[b]);return c},isSelectedNode:function(b){return a.isSelectedNode(this.setting,b)},reAsyncChildNodes:function(d,g,h){if(this.setting.async.enable){var f=!d;f&&(d=a.getRoot(this.setting));g=="refresh"&&(d[this.setting.data.key.children]=[],f?this.setting.treeObj.empty():e("#"+d.tId+b.id.UL).empty());c.asyncNode(this.setting,f?null:d,!!h)}},refresh:function(){this.setting.treeObj.empty();var b=a.getRoot(this.setting),d=b[this.setting.data.key.children];a.initRoot(this.setting);b[this.setting.data.key.children]=d;a.initCache(this.setting);c.createNodes(this.setting,0,b[this.setting.data.key.children])},selectNode:function(a,f){a&&d.uCanDo(this.setting)&&(f=h.view.selectedMulti&&f,a.parentTId?c.expandCollapseParentNode(this.setting,a.getParentNode(),!0,!1,function(){e("#"+a.tId+b.id.ICON).focus().blur()}):e("#"+a.tId+b.id.ICON).focus().blur(),c.selectNode(this.setting,a,f))},transformTozTreeNodes:function(b){return a.transformTozTreeFormat(this.setting,b)},transformToArray:function(b){return a.transformToArrayFormat(this.setting,b)},updateNode:function(a){a&&e("#"+a.tId).get(0)&&d.uCanDo(this.setting)&&(c.setNodeName(this.setting,a),c.setNodeTarget(a),c.setNodeUrl(this.setting,a),c.setNodeLineIcos(this.setting,a),c.setNodeFontCss(this.setting,a))}};j.treeTools=i;a.setZTreeTools(h,i);j[k]&&j[k].length>0?c.createNodes(h,0,j[k]):h.async.enable&&h.async.url&&h.async.url!==""&&c.asyncNode(h);return i}};var A=e.fn.zTree,b=A.consts})(jQuery)